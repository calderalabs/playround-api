<% if signed_in? && current_user.show_guiders %>
  <%= content_for :javascripts do %>
    <%= javascript_include_tag 'guider' %>

    <script type="text/javascript" charset="utf-8">
      $(function() {
        guider.createGuider({
          buttons: [{name: "Next"}, {name: "No, thanks", onclick: guider.hideAll}],
          description: "This is your first time signing in Playround. Click next to begin a quick tour showing you what is this all about.",
          id: "welcome",
          next: "location",
          overlay: true,
          title: "Welcome to Playround!"
        }).show();
        
        guider.createGuider({
          attachTo: "#change-location",
          buttons: [{name: "Next"}],
          description: "The first thing to do, if it is not correct, is to change your current city by clicking this label. Just enter the city you live in in the box that appears to you.",
          id: "location",
          next: "profile",
          position: 6,
          title: "Change your location"
        })
        
        guider.createGuider({
          attachTo: "#change-profile",
          buttons: [{name: "Next"}],
          description: "Here you can fill some informations about you. This will help others to know a little more about who you are. It is strongly reccomended to put your list of favorite games to improve your Playround experience.",
          id: "profile",
          next: "rounds",
          position: 6,
          title: "Change profile"
        })
        
        guider.createGuider({
          attachTo: "#rounds-nav",
          buttons: [{name: "Next"}],
          description: "This section will show you the list of rounds around you. Rounds are matches organized by users or public places that will allow you to meet new people while playing games together. Every round is associated to a real place, or arena, and they're not meant to organize online matches.",
          id: "rounds",
          next: "rounds",
          position: 6,
          title: "What are rounds?"
        })
      });
    </script>
  <% end %>

  <%= content_for :stylesheets do %>
    <%= stylesheet_link_tag 'guider' %>
  <% end %>
<% end %>

<!DOCTYPE html>
<html>
  <head>
    <title>Playround | Stop sharing. Start being.</title>
    <%= stylesheet_link_tag 'playround', 'jquery-ui/jquery.ui.all' %>
    <%= yield :stylesheets %>
    
    <%= csrf_meta_tag %>
  </head>
<body>
  <% unless flash.empty? %>
    <div id="flash">
      <% flash.each do |key, value| -%>
        <div id="flash_<%= key %>"><%=h value %></div>
      <% end %>
    </div>
  <% end %>
    <div id="session">
      <div class="container">
        <%= form_tag location_path, :method => :put, :id => 'location-form' do |f| %>
          <%= hidden_field_tag 'redirect_to', request.request_uri %>
          <%= text_field_tag 'location', '' %>
        <% end %>
        
        <%= link_to(located? ? [current_location.name, current_location.country].join(', ') : 'Unknown location', '/', :id => 'change-location') %> |
        
        <% if signed_in? -%>
          <%= link_to current_user.display_name, user_path(current_user), :id => 'change-profile' %> |
          <%= link_to "Sign out", sign_out_path, :method => :delete %>
        <% else -%>
          <%= link_to "Sign in", sign_in_path %>
        <% end -%>
      </div>
    </div>
    <div id="header">
    <div class="container">
      <div class="left-column">
        <%= link_to(image_tag('logo-small.png'), root_path) %>
      </div>
      <div class="right-column">
        <ul>
          <li><%= link_to "Rounds", rounds_path, :id => 'rounds-nav' %> </li>
          <li><%= link_to "Arenas", arenas_path, :id => 'arenas-nav' %> </li>
          <li><%= link_to "Games", games_path, :id => 'games-nav' %> </li>
          <li><%= link_to "People", users_path, :id => 'people-nav' %> </li>
        </ul>
      </div>
    </div>
</div>
    <div id="content">
      <div class="container">
      <%= yield %>
</div>
    </div>
    <div id="footer">
      <p>Copyright Â© Playround 2011. All rights reserved.</p>
    </div>
</body>

<%= javascript_include_tag :defaults %>
<%= javascript_include_tag 'autocomplete-rails.js' %>

<script type="text/javascript" charset="utf-8">
  $(function() {
    $('#location-form').css('display', 'none');
    
    $('#location-form input').blur(function(event) {
      $('#location-form').css('display', 'none');
      $('#change-location').css('display', 'inline');
    });
    $('#change-location').click(function(event){
      $(this).css('display', 'none');
      $('#location-form').css('display', 'inline');
      $('#location-form input').focus();
      
      event.preventDefault();
    });
  });
</script>

<%= yield :javascripts %>
</html>
